FROM centos:centos7
MAINTAINER Zenoss <dev@zenoss.com>

RUN yum clean all

# Add zenoss tools
RUN yum --exclude=systemd\* --exclude=iputils\* update -y && \

# TODO: change this repo to use zenoss yum repo
yum install epel-release -y && \

rpmdb --rebuilddb && \
yum install -y \
    emacs-nox \
    file \
    gzip \
    rsync \
    tar \
    telnet \
    traceroute \
    vim \
    wget \
    which \
    zip \
    sudo>=1.8.6 \
    openssh-clients \
    binutils \
    device-mapper-libs \
    libaio \
    libgomp \
    openssl-devel \
    pcre-devel \
    protobuf-python \
    alsa-lib \
    bind-libs \
    bind-license \
    bind-utils \
    flac-libs \
    gsm \
    libart_lgpl \
    libasyncns \
    libogg \
    libsndfile \
    libtirpc \
    libvorbis \
    rpcbind \
    ttmkfdir \
    tzdata-java \
    xorg-x11-fonts-Type1 && \
yum erase epel-release -y && \
yum clean all

# Symlink /etc/localtime
RUN rm -f /etc/localtime && ln -s /usr/share/zoneinfo/UTC /etc/localtime

# Creating sym link to remedy library import of serviced
RUN ln -s /lib64/libdevmapper.so.1.02 /lib64/libdevmapper.so.1.02.1

ADD ./rpm/pkgroot/%RPM% /tmp/%RPM%

RUN yum install epel-release -y && \
rpmdb --rebuilddb && \
yum -y install /tmp/%RPM% && \
yum erase epel-release -y && \
yum clean all


RUN rm -rf /tmp/*
